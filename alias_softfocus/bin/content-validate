#!/usr/bin/env bash
set -euo pipefail

VALIDATE_SCRIPT="scripts/validate-content.js"
AUDIENCE_SCRIPT="scripts/check-audience-coverage.js"

run() {
  if [ "${DRY_RUN:-0}" = "1" ]; then
    echo "[DRY_RUN] $*"
  else
    "$@"
  fi
}

for SCRIPT in "$VALIDATE_SCRIPT" "$AUDIENCE_SCRIPT"; do
  if [ ! -f "$SCRIPT" ]; then
    echo "ERROR: content-validate target missing: $SCRIPT" >&2
    exit 1
  fi
done

run node "$VALIDATE_SCRIPT" "$@"
run node "$AUDIENCE_SCRIPT" "$@"
