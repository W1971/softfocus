# SoftFocus — Логирование тестов и поток выполнения

Version: v1.0  
Status: ACTIVE  
Audience: Core maintainers  
Locale: RU  

---

## Назначение

Данный документ определяет **каноническую систему логирования и выполнения тестов**
в рамках governance SoftFocus.

Система предназначена для обеспечения:

- прозрачности выполнения;
- воспроизводимости RUN’ов;
- управляемости решений;
- аудируемости тестовых результатов.

---

## Основные компоненты

### 1. Человекочитаемый лог

- Скрипт: `scripts/audit/append-run-log.sh`
- Путь: `tests/runs/<RUN_ID>/run.log`
- Формат: обычный текст
- Свойства:
  - строго линейный;
  - append-only;
  - ориентирован на ручную инспекцию.

---

### 2. Машинный лог (JSONL)

- Скрипт: `scripts/audit/append-run-jsonl.sh`
- Путь: `tests/runs/<RUN_ID>/run.jsonl`
- Формат: JSON Lines (один объект на строку)
- Свойства:
  - append-only;
  - порядок строк отражает порядок событий;
  - используется для аналитики и дашбордов.

---

## RUN_ID

Каждый RUN:

- имеет уникальный RUN_ID;
- создаёт одну директорию `tests/runs/<RUN_ID>`;
- никогда не перезаписывается;
- используется как первичный идентификатор аудита.

Повторное использование RUN_ID **запрещено**.

---

## Тестовые сценарии

Тестовые сценарии:

- реализуются как shell-скрипты;
- обязаны использовать официальные логгеры;
- считаются недействительными без логирования.

Пример сценария:

- `TS-READY-BASE-001`

---

## Проверка логов

Каждый RUN **обязан** пройти проверку логов
с помощью скрипта:

tests/helpers/verify-test-logs.sh    
Проверка гарантирует наличие:

- `run.log`;
- `run.jsonl`.

Отсутствие любого из логов
считается нарушением governance.

---

## Инварианты

Следующие правила являются **жёсткими**:

- все логи append-only;
- логи никогда не редактируются;
- тесты не модифицируют прошлые RUN’ы;
- решения всегда трассируемы;
- отсутствие логов блокирует governance.

---

## Поток выполнения (Execution Flow)

1. Генерация RUN_ID
2. Создание директории RUN
3. Выполнение тестовых сценариев
4. Запись человекочитаемых логов
5. Запись машинных логов
6. Проверка логов
7. READY-классификация
8. Завершение RUN

Пропуск любого шага **запрещён**.

---

## Результат

Данная система позволяет:

- видеть полную историю RUN’ов;
- анализировать риск во времени;
- автоматизировать контроль;
- сохранять человеческий надзор.

---

## Финальное положение

Система логирования и выполнения тестов
является **обязательной частью архитектуры SoftFocus**.

Любые изменения требуют:
- новой версии документа;
- обновления связанных скриптов;
- повторной валидации governance.

